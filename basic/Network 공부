* 네트워크 쉽게 더 쉽게 정리

WAN

1. 액세스 라우터 / 브로드밴드 라우터
2. 회선 종단 장치 : WAN - LAN 변환 : ONU(광 통신망 유닛), 모뎀, TA, DSU
3. 액세스 회선
4. WAN 중계망

ISDN -> BRI/PRI 인터페이스


스위치 입문

리피터 허브와 브릿지

리피터 하브는 PC나 네트워크 기기 등 단말에서 LAN 케이블을 한 곳에 모아 통신 데이터를 중계함
전송 규칙은 주로 CSMA/CD(Carrier Sense Multiple Access / Collision Detection) 방식을 채용

CSMA/CD 에서 데이터 손실이 발생하는 범위를 콜리전 도메인이라 부름

콜리전 도메인 구간은 1:1 통신만 가능함 (안 그러면 충돌)

그러나 현대에서는 연결 기기가 많아짐에 따라 콜리전 도메인을 작게 나누어야 하는데

리피터 하브에서는 해당 기능이 불가능하므로 스위치와 브릿지로 역할이 대체됨


브릿지는 콜리전 도메인을 분할할 수 있다. // 브릿지도 데이터 링크 계층

브릿지는 MAC 주소 테이블을 통해 프레임 내의 MAC 주소를 필터링 하여 프레임을 통과시킬지 판단함

이것이 네트워크 간 불필요한 데이터 송신을 억제하여 콜리전 발생을 방지함

* 리피터 허브는 네트워크 규모의 발전에 따라 CSMA/CD 방식의 통용이 어려워 브릿지로 대체됨

* 브릿지 : 프레임 필터링 (콜리전 방지), 트래픽 정리

* 콜리전 도메인 방지 : 브릿지, 스위치 허브



리피터 허브는 모든 포트에 데이터를 보냄 (전체 콜리전 도메인)
브릿지, 스위치 허브는 포트별 데이터를 제어함 (포트별 콜리전 도메인)

다시 시간이 지나며 성능의 차이로 인해 브릿지에서 스위치로 교체됨

브릿지는 프레임 분석과 전송 처리를 소프트웨어에서 함
스위치는 하드웨어 단계에서 처리함 (ASIC 사용)

스위치는 OSI 2계층에 대응되는 중계기이다.

L2 스위치는 접속 단말의 MAC 주소와 접속 포트 정보를 자동으로 MAC 주소 테이블에 저장하여
포트별 전송 프레임을 제어함

VLAN을 통해 브로드캐스트 도메인을 여러개로 분할 가능해짐



VLAN

VLAN을 사용하면 물리적 환경을 무시하고 논리적으로 네트워크를 분할가능

네트워크를 분할한다는 것은 브로드캐스트 도메인 역시 분할이 가능하다는 의미이다.

* 포트VLAN = 정적VLAN


트렁크 링크

만약 1층과 3층의 서로 다른 스위치를 쓰는 부서가 VLAN을 구성하는 경우
스위치간 연결을 위해 구성한 전용링크이다. 예를들어 1층과 3층 스위치는 각자 24번 포트를
사용하여 물리적으로 서로 연결한다. 이렇게 구성한 트렁크 링크를 통해
VLAN의 데이터를 주고받는다.


* 만약 VLAN이 다른 호스트간 통신을 한다면?

하나의 스위치더라도 VLAN 간에는 서로 독립된 네트워크이다.

따라서 라우팅 기능을 가진 L3 스위치가 필요하다.


ex)
===L2===    ===L2===
      l            l
      x  ->     라우터
      l            l
===L2===    ===L2===


다른 네트워크의 호스트와 통신하기 위해서는 네트워크 계층
L3 스위치가 필요하지만 소규모 네트워크에서는 그냥 라우터만 있어도 된다.

최근에는 브로드밴드화가 진행된 결과, 서버를 데이터 센터에 집중시키는 경향이 있으므로

LAN과 WAN을 구분하는 작업은 L3스위치가 담당하고 라우터는 WAN 접속 전용하는 것이 대부분이다.



L3 스위치는 L2 스위치에 라우터 기능이 더해진 스위치다.

L2와 마찬가지로 ASIC 칩을 통해 하드웨어 단계에서 처리하여 성능 향상을 추구함

라우터 기능이 있기 때문에 VLAN간 통신이 가능함



위 단계까지는 네트워크 계층 레벨까지의 IP인프라를 구축 한 것뿐이다.

즉, 실제 사용자가 사용하는 애플리케이션 레벨 L4 이상의 계층에 대한 보완은 이루어지지 않음


예를들어 '웹 서버 응답속도가 느려졌다..' 라는 문의가 들어왔다면

두 가지 문제를 먼저 의심해보아야 한다.

- 네트워크 인프라 전체에 발생한 문제인가? -> L3 이하의 문제 (해비 트래픽)
- 웹 서버 자체의 문제인가? -> L4 이상의 보완 필요 (웹 서버의 부하 과중)

L4 이상의 문제 해결은 두 가지를 고려할 수 있다.
- 웹 서버 사양 업그레이드
- 로드 밸런서 도입


로드밸런서
- 부하분산
- 상태확인
- 세션유지



중/대규모 엔터프라이즈급 네트워크는 신뢰성을 높이기 위해 네트워크 이중화를 실시한다.

스패닝 트리 프로토콜 (Spanning Tree Protocol, 이하 STP)
: 스위치 본체 또는 스위치 간 링크 장애에 대한 이중화 방법

STP는 이중 경로에 의해 루프 상태가 되지 않도록 특정 포트를 막아 트리 상태의 네트워크를 만든다.

STP는 BPUD(Bridge Protocol Data Unit) 제어정보를 지속적으로 주고받아 네트워크가
정상적으로 동작하는지 감시한다.

장애 검출 시 스패닝 트리 재형성

네트워크의 데이터가 루프상태에 빠지면 안 됨



그러나 STP는 정상 상태에서 대역 낭비와 네트워크 장애발생을 고려한 설계를 해야 하므로
문제가 많다.

이를 해결하기 위해 '스택 접속' + '링크 어그리게이션(집합, 무리 : aggregation)'

* 스택 접속 : 여러 스위치를 논리적으로 하나의 장치로서 인식하는 기능

  이를 사용하면 이중화 구성중 통상 모드에서도 모든 스위치를 사용 가능함

* 링크 aggregation : 여러 회선을 묶어 하나의 링크로 만드는 방법

  이를 사용하면 이중화 구성 중 상위 스위치와 연결되는 여러 회선의 대역을

  통상모드에서도 낭비 없이 사용할 수 있다.\




라우터

지금까지 라우터는 WAN과 LAN을 연결하는 장치로만 배워왔다.

중/대규모 거점 네트워크에서 라우터는 WAN과의 연결만 담당하고 L3 스위치와 역할을
분담하게 됬지만 더 전문적으로 발전함. (데이터 전송에 특화)

신뢰성, 보다 빠른 패킷 처리


물론 소규모 거점의 라우터는 데이터 전달부터 보안 등 여러 역할을 겸임한다.


2계층에 속한 브릿지나 스위치가 물리 주소 MAC을 기반으로 처리하는 것에 비하여,
라우터는 3계층의 논리 주소 IP 주소를 기반으로 라우팅을 처리한다.


라우터는 다른 네트워크를 연결하는 역할이라 알고 있으나
정확하게는 적절한 네트워크로 분배하는 역할도 한다.

라우터는 보유한 '라우팅 테이블'상의 정보를 가지고 패킷을 라우팅한다.

라우터 역시 라우팅 테이블을 자동학습과 수동학습 2가지 방법이 모두 가능하다.

중/대규모 네트워크에서 관리자는 라우터의 부담을 줄이기 위해 콘솔을 통해
수동으로 라우팅 테이블을 등록해야 한다.

자동으로 학습하는 동적 라우팅 방식은 라우터나 네트워크 자체에 부하가 발생할 수 있음

*RIP(Routing Information Protocol) : 대표적인 라우팅 프로토콜


동적 라우팅 정보를 학습하는 알고리즘은 크게 3가지가 있다.
- Distance Vector Algorithm : 인접한 라우터끼리 라우팅 정보를 학습함. 대표적 프로토콜로 RIP가 있다.
  * RIP는 최대 15홉 라우터까지 전송 가능함. 대규모 네트워크에서는 부적합

- Link State Algorithm : 라우터 자체가 접속한 네트워크에 대한 정보를 범위 내 모든 라우터에게 통지한다.
 * 대표적으로 OSPF 가 있으며, 네트워크를 계층 구조화하여 서브넷 마스크에 사용할 수 있다. (대규모 네트워크에서만 사용 가능함)
 * 생긴게 딱 가중치 그래프 (최적 경로 계산)

- Path Vector Algorithm

일치하는 라우팅 정보가 없을 때 할당되는 경로

일치하는 경로가 없을 때 패킷을 파기하거나 미리 설정해둔 기본 경로로 보낼 수 있다.

개념은 기본 게이트웨이와 비슷하게 '자신이 소속된 네트워크 이외의 다른 곳에 데이터를 보낼 때에는 반드시 여기로 보내라'
라는 목적지 설정이다.

실제로 네트워크 경계에 존재하는 라우터 IP 주소를 기본 게이트웨이로 설정한다.



라우터는 사용 환경에 따라 몇 가지 종류가 있다.

1. 서비스 프로바이더용 네트워크 : 광역 이더넷, IP-VPN : 코어 라우터, 엣지 라우터 (광역 이더넷 망에 존재함)
2. 대규모 거점 네트워크 :
3. 중/소규모 거점 네트워크
4. 서버 팜
5. WAN 네트워크
